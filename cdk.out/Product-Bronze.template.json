{
  "Parameters": {
    "custId": {
      "Type": "String",
      "Description": "The id of the customer."
    }
  },
  "Resources": {
    "databasebronze01SubnetGroupE5FE2E1C": {
      "Type": "AWS::RDS::DBSubnetGroup",
      "Properties": {
        "DBSubnetGroupDescription": "Subnet group for database-bronze01 database",
        "SubnetIds": [
          "subnet-0779e285b826ab7bb",
          "subnet-0ae6a81c2fb31bf1c",
          "subnet-0e7e8a245404a0672"
        ],
        "Tags": [
          {
            "Key": "custID",
            "Value": {
              "Ref": "custId"
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "product-bronze/database-bronze01/SubnetGroup/Default"
      }
    },
    "databasebronze01SecurityGroup3722B1B3": {
      "Type": "AWS::EC2::SecurityGroup",
      "Properties": {
        "GroupDescription": "Security group for database-bronze01 database",
        "SecurityGroupEgress": [
          {
            "CidrIp": "0.0.0.0/0",
            "Description": "Allow all outbound traffic by default",
            "IpProtocol": "-1"
          }
        ],
        "Tags": [
          {
            "Key": "custID",
            "Value": {
              "Ref": "custId"
            }
          }
        ],
        "VpcId": "vpc-0dd89814b25526eb9"
      },
      "Metadata": {
        "aws:cdk:path": "product-bronze/database-bronze01/SecurityGroup/Resource"
      }
    },
    "databasebronze01Secret16C11F5E": {
      "Type": "AWS::SecretsManager::Secret",
      "Properties": {
        "Description": {
          "Fn::Join": [
            "",
            [
              "Generated by the CDK for stack: ",
              {
                "Ref": "AWS::StackName"
              }
            ]
          ]
        },
        "GenerateSecretString": {
          "ExcludeCharacters": " %+~`#$&*()|[]{}:;<>?!'/@\"\\",
          "GenerateStringKey": "password",
          "PasswordLength": 30,
          "SecretStringTemplate": "{\"username\":\"postgres\"}"
        },
        "Tags": [
          {
            "Key": "custID",
            "Value": {
              "Ref": "custId"
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "product-bronze/database-bronze01/Secret/Resource"
      }
    },
    "databasebronze01SecretAttachment7022D8D3": {
      "Type": "AWS::SecretsManager::SecretTargetAttachment",
      "Properties": {
        "SecretId": {
          "Ref": "databasebronze01Secret16C11F5E"
        },
        "TargetId": {
          "Ref": "databasebronze0115B50823"
        },
        "TargetType": "AWS::RDS::DBInstance"
      },
      "Metadata": {
        "aws:cdk:path": "product-bronze/database-bronze01/Secret/Attachment/Resource"
      }
    },
    "databasebronze0115B50823": {
      "Type": "AWS::RDS::DBInstance",
      "Properties": {
        "DBInstanceClass": "db.r4.large",
        "AllocatedStorage": "100",
        "CopyTagsToSnapshot": true,
        "DBName": "db1",
        "DBSubnetGroupName": {
          "Ref": "databasebronze01SubnetGroupE5FE2E1C"
        },
        "DeletionProtection": false,
        "Engine": "postgres",
        "EngineVersion": "12.4",
        "MasterUsername": {
          "Fn::Join": [
            "",
            [
              "{{resolve:secretsmanager:",
              {
                "Ref": "databasebronze01Secret16C11F5E"
              },
              ":SecretString:username::}}"
            ]
          ]
        },
        "MasterUserPassword": {
          "Fn::Join": [
            "",
            [
              "{{resolve:secretsmanager:",
              {
                "Ref": "databasebronze01Secret16C11F5E"
              },
              ":SecretString:password::}}"
            ]
          ]
        },
        "Port": "5432",
        "StorageType": "gp2",
        "Tags": [
          {
            "Key": "custID",
            "Value": {
              "Ref": "custId"
            }
          }
        ],
        "VPCSecurityGroups": [
          {
            "Fn::GetAtt": [
              "databasebronze01SecurityGroup3722B1B3",
              "GroupId"
            ]
          }
        ]
      },
      "UpdateReplacePolicy": "Delete",
      "DeletionPolicy": "Delete",
      "Metadata": {
        "aws:cdk:path": "product-bronze/database-bronze01/Resource"
      }
    },
    "CDKMetadata": {
      "Type": "AWS::CDK::Metadata",
      "Properties": {
        "Modules": "aws-cdk=1.73.0,@aws-cdk/assets=1.78.0,@aws-cdk/aws-apigateway=1.78.0,@aws-cdk/aws-applicationautoscaling=1.78.0,@aws-cdk/aws-autoscaling-common=1.78.0,@aws-cdk/aws-certificatemanager=1.78.0,@aws-cdk/aws-cloudwatch=1.78.0,@aws-cdk/aws-codeguruprofiler=1.78.0,@aws-cdk/aws-ec2=1.78.0,@aws-cdk/aws-ecr=1.78.0,@aws-cdk/aws-ecr-assets=1.78.0,@aws-cdk/aws-efs=1.78.0,@aws-cdk/aws-elasticloadbalancingv2=1.78.0,@aws-cdk/aws-events=1.78.0,@aws-cdk/aws-iam=1.78.0,@aws-cdk/aws-kms=1.78.0,@aws-cdk/aws-lambda=1.78.0,@aws-cdk/aws-logs=1.78.0,@aws-cdk/aws-rds=1.78.0,@aws-cdk/aws-route53=1.78.0,@aws-cdk/aws-s3=1.78.0,@aws-cdk/aws-s3-assets=1.78.0,@aws-cdk/aws-sam=1.78.0,@aws-cdk/aws-secretsmanager=1.78.0,@aws-cdk/aws-sqs=1.78.0,@aws-cdk/aws-ssm=1.78.0,@aws-cdk/cloud-assembly-schema=1.78.0,@aws-cdk/core=1.78.0,@aws-cdk/cx-api=1.78.0,@aws-cdk/region-info=1.78.0,jsii-runtime=Python/3.9.0"
      },
      "Metadata": {
        "aws:cdk:path": "product-bronze/CDKMetadata/Default"
      }
    }
  }
}